{"ast":null,"code":"import axios from \"axios\";\nconst SET_OAUTH_USER = 'SET_OAUTH_USER';\nconst SET_OAUTH_DATA = 'SET_OAUTH_DATA';\nlet initalState = {\n  user: null,\n  accessToken: null,\n  expiresIn: null,\n  userId: null,\n  email: null\n};\n\nconst OAuthReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initalState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case SET_OAUTH_USER:\n      return { ...state,\n        user: action.user\n      };\n\n    case SET_OAUTH_DATA:\n      const dataToken = action.location.match(/\\w+=\\w+/mg);\n\n      if (dataToken) {\n        const accessToken = dataToken[0].match(/=\\w+/)[0].slice(1);\n        const expiresIn = dataToken[1].match(/=\\w+/)[0].slice(1);\n        const userId = dataToken[2].match(/=\\w+/)[0].slice(1);\n        const email = location.match(/\\w+@\\w+.\\w+/)[0];\n        if (accessToken) return { ...state,\n          accessToken: accessToken,\n          expiresIn: expiresIn,\n          userId: userId,\n          email: email\n        };\n      }\n\n      break;\n\n    default:\n      return state;\n  }\n};\n\n_c = OAuthReducer;\n\nconst setOAuthUser = user => ({\n  type: SET_OAUTH_USER,\n  user\n});\n\nexport const getOAuthData = location => ({\n  type: SET_OAUTH_DATA,\n  location\n});\nexport const getOAuthUser = props => {\n  return dispatch => {\n    axios.get(`https://api.vk.com/method/users.get?user_ids=${props.userId}&access_token=${props.accessToken}&v=5.131`, {\n      headers: {\n        \"Access-Control-Allow-Origin\": \"*\",\n        \"Access-Control-Allow-Headers\": \"*\",\n        \"Access-Control-Allow-Methods\": \"*\",\n        'Access-Control-Allow-Credentials': 'true',\n        'Content-Type': 'application/json'\n      }\n    }).then(response => dispatch(setOAuthUser(response.data)));\n  };\n};\nexport default OAuthReducer;\n\nvar _c;\n\n$RefreshReg$(_c, \"OAuthReducer\");","map":{"version":3,"sources":["C:/Users/FORTRIX/Desktop/react_project/src/redux/OAuthReducer.js"],"names":["axios","SET_OAUTH_USER","SET_OAUTH_DATA","initalState","user","accessToken","expiresIn","userId","email","OAuthReducer","state","action","type","dataToken","location","match","slice","setOAuthUser","getOAuthData","getOAuthUser","props","dispatch","get","headers","then","response","data"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,MAAMC,cAAc,GAAG,gBAAvB;AACA,MAAMC,cAAc,GAAG,gBAAvB;AAEA,IAAIC,WAAW,GAAG;AAChBC,EAAAA,IAAI,EAAE,IADU;AAGhBC,EAAAA,WAAW,EAAE,IAHG;AAIhBC,EAAAA,SAAS,EAAE,IAJK;AAKhBC,EAAAA,MAAM,EAAE,IALQ;AAMhBC,EAAAA,KAAK,EAAE;AANS,CAAlB;;AASA,MAAMC,YAAY,GAAG,YAAiC;AAAA,MAAhCC,KAAgC,uEAAxBP,WAAwB;AAAA,MAAXQ,MAAW;;AACpD,UAAQA,MAAM,CAACC,IAAf;AAEE,SAAKX,cAAL;AACE,aAAO,EACL,GAAGS,KADE;AAELN,QAAAA,IAAI,EAAEO,MAAM,CAACP;AAFR,OAAP;;AAKF,SAAKF,cAAL;AACE,YAAMW,SAAS,GAAGF,MAAM,CAACG,QAAP,CAAgBC,KAAhB,CAAsB,WAAtB,CAAlB;;AACA,UAAIF,SAAJ,EAAe;AACb,cAAMR,WAAW,GAAGQ,SAAS,CAAC,CAAD,CAAT,CAAaE,KAAb,CAAmB,MAAnB,EAA2B,CAA3B,EAA8BC,KAA9B,CAAoC,CAApC,CAApB;AACA,cAAMV,SAAS,GAAGO,SAAS,CAAC,CAAD,CAAT,CAAaE,KAAb,CAAmB,MAAnB,EAA2B,CAA3B,EAA8BC,KAA9B,CAAoC,CAApC,CAAlB;AACA,cAAMT,MAAM,GAAGM,SAAS,CAAC,CAAD,CAAT,CAAaE,KAAb,CAAmB,MAAnB,EAA2B,CAA3B,EAA8BC,KAA9B,CAAoC,CAApC,CAAf;AACA,cAAMR,KAAK,GAAGM,QAAQ,CAACC,KAAT,CAAe,aAAf,EAA8B,CAA9B,CAAd;AACA,YAAIV,WAAJ,EACE,OAAO,EACL,GAAGK,KADE;AAELL,UAAAA,WAAW,EAAEA,WAFR;AAGLC,UAAAA,SAAS,EAAEA,SAHN;AAILC,UAAAA,MAAM,EAAEA,MAJH;AAKLC,UAAAA,KAAK,EAAEA;AALF,SAAP;AAOH;;AACD;;AAEF;AAAS,aAAOE,KAAP;AA1BX;AA4BD,CA7BD;;KAAMD,Y;;AA+BN,MAAMQ,YAAY,GAAIb,IAAD,KAAW;AAAEQ,EAAAA,IAAI,EAAEX,cAAR;AAAwBG,EAAAA;AAAxB,CAAX,CAArB;;AACA,OAAO,MAAMc,YAAY,GAAIJ,QAAD,KAAe;AAAEF,EAAAA,IAAI,EAAEV,cAAR;AAAwBY,EAAAA;AAAxB,CAAf,CAArB;AAEP,OAAO,MAAMK,YAAY,GAAIC,KAAD,IAAW;AACrC,SAAQC,QAAD,IAAc;AACnBrB,IAAAA,KAAK,CAACsB,GAAN,CAAW,gDAA+CF,KAAK,CAACb,MAAO,iBAAgBa,KAAK,CAACf,WAAY,UAAzG,EAAoH;AAClHkB,MAAAA,OAAO,EAAE;AACP,uCAA+B,GADxB;AAEP,wCAAgC,GAFzB;AAGP,wCAAgC,GAHzB;AAIP,4CAAoC,MAJ7B;AAKP,wBAAgB;AALT;AADyG,KAApH,EAQGC,IARH,CASIC,QAAQ,IAAIJ,QAAQ,CAACJ,YAAY,CAACQ,QAAQ,CAACC,IAAV,CAAb,CATxB;AAWD,GAZD;AAaD,CAdM;AAgBP,eAAejB,YAAf","sourcesContent":["import axios from \"axios\";\r\n\r\nconst SET_OAUTH_USER = 'SET_OAUTH_USER';\r\nconst SET_OAUTH_DATA = 'SET_OAUTH_DATA';\r\n\r\nlet initalState = {\r\n  user: null,\r\n\r\n  accessToken: null,\r\n  expiresIn: null,\r\n  userId: null,\r\n  email: null\r\n}\r\n\r\nconst OAuthReducer = (state = initalState, action) => {\r\n  switch (action.type) {\r\n\r\n    case SET_OAUTH_USER:\r\n      return {\r\n        ...state,\r\n        user: action.user\r\n      }\r\n\r\n    case SET_OAUTH_DATA:\r\n      const dataToken = action.location.match(/\\w+=\\w+/mg);\r\n      if (dataToken) {\r\n        const accessToken = dataToken[0].match(/=\\w+/)[0].slice(1);\r\n        const expiresIn = dataToken[1].match(/=\\w+/)[0].slice(1);\r\n        const userId = dataToken[2].match(/=\\w+/)[0].slice(1);\r\n        const email = location.match(/\\w+@\\w+.\\w+/)[0];\r\n        if (accessToken)\r\n          return {\r\n            ...state,\r\n            accessToken: accessToken,\r\n            expiresIn: expiresIn,\r\n            userId: userId,\r\n            email: email\r\n          }\r\n      }\r\n      break;\r\n\r\n    default: return state;\r\n  }\r\n}\r\n\r\nconst setOAuthUser = (user) => ({ type: SET_OAUTH_USER, user })\r\nexport const getOAuthData = (location) => ({ type: SET_OAUTH_DATA, location })\r\n\r\nexport const getOAuthUser = (props) => {\r\n  return (dispatch) => {\r\n    axios.get(`https://api.vk.com/method/users.get?user_ids=${props.userId}&access_token=${props.accessToken}&v=5.131`, {\r\n      headers: {\r\n        \"Access-Control-Allow-Origin\": \"*\",\r\n        \"Access-Control-Allow-Headers\": \"*\",\r\n        \"Access-Control-Allow-Methods\": \"*\",\r\n        'Access-Control-Allow-Credentials': 'true',\r\n        'Content-Type': 'application/json',\r\n      }\r\n    }).then(\r\n        response => dispatch(setOAuthUser(response.data))\r\n    )\r\n  }\r\n}\r\n\r\nexport default OAuthReducer;"]},"metadata":{},"sourceType":"module"}